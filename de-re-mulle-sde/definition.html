<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8">
<!-- seems to be needed -->

<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">

<title>💄 Definition isolator &#8211; De Re mulle-sde</title>
<meta name="description" content="The mulle-sde virtual environment shields the project from
unintentional environment settings. But that is not enough separation, if the
project is made up of multiple projects (a.k.a. “dependencies”).
">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="💄 Definition isolator">
<meta name="twitter:description" content="The mulle-sde virtual environment shields the project from unintentional environment settings. But that is not enough separation, if the project is made up of multiple projects (a.k.a. “dependencies”). Here is a contrived example. The main project get its current version via the commandline like cc -DVERSION='"1"'. Lets use the mulle-sde...">
<meta name="twitter:site" content="@mulle_nat">
<meta name="twitter:creator" content="@mulle_nat">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.mulle-kybernetik.com/de-re-mulle-sde/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="💄 Definition isolator">
<meta property="og:description" content="The mulle-sde virtual environment shields the project from unintentional environment settings. But that is not enough separation, if the project is made up of multiple projects (a.k.a. “dependencies”). Here is a contrived example. The main project get its current version via the commandline like cc -DVERSION='"1"'. Lets use the mulle-sde...">
<meta property="og:url" content="https://www.mulle-kybernetik.com/definition.html">
<meta property="og:site_name" content="De Re mulle-sde">

<meta property="og:image" content="https://www.mulle-kybernetik.com/de-re-mulle-sde/images/default-thumb.png">

<meta property="og:logo" content="https://www.mulle-kybernetik.com/de-re-mulle-sde/images/logo.png">



<link href="/de-re-mulle-sde/atom.xml" type="application/atom+xml" rel="alternate" title="De Re mulle-sde Feed">
<link href="/de-re-mulle-sde/index.rdf" type="application/rss+xml" rel="alternate" title="De Re mulle-sde Feed">


<link rel="canonical" href="https://www.mulle-kybernetik.com/definition.html">


<!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
<meta name="viewport" content="width=device-width, initial-scale=1">


<!-- CSS
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/skeleton.css">

<!-- Code Color
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link rel="stylesheet" href="css/monokai.css">

<!-- Site custom css -->
<link rel="stylesheet" href="css/custom.css">

<!-- local FONT
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link rel="stylesheet" href="css/junction.css">

<!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link rel="icon" type="image/svg" href="images/favicon.svg">

<!-- This tag allows for activation of ClearType in Mobile IE for smoothing fonts.-->
<meta http-equiv="cleartype" content="on">
<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->


</head>
<body class="post">
  <div class="container">
      <div class="row">
         <div id="post-first" class="four columns">
            <div class="sideline">
            <div class="bio">
               

               <div class="bio-photo-container" style="display: inline-block">
                     
                     <img src="images/dog-pic.jpg" class="bio-photo" alt="Nat! bio photo">
                     
               </div>
               <div style="display: inline-block; padding-left: 8px">
                     <h4>Nat!</h4>
                     <p>Senior Mull</p>
               </div>

               <div class="author-social"><a href="//www.mulle-kybernetik.com" target="_blank" class="link"><img class="inline-img" src="images/homepage-svgrepo-com.svg"></a>&nbsp;&nbsp;<a href="//www.mulle-kybernetik.com" target="_blank" class="link">WWW</a></div>

               <div class="author-social"><a href="mailto:nat-de-re-mulle-sde@emulle-kybernetik.com" target="_blank"><img class="inline-img" src="images/email-svgrepo-com.svg"></a>&nbsp;&nbsp;<a href="mailto:nat-de-re-mulle-sde@emulle-kybernetik.com" target="_blank" class="link">Email</a></div>
               <div class="author-social"><a href="//twitter.com/mulle_nat" target="_blank"><img class="inline-img" src="images/twitter-svgrepo-com.svg"></a>&nbsp;&nbsp;<a href="//twitter.com/mulle_nat" target="_blank" class="link">Twitter</a></div>

               <div class="author-social"><a href="//github.com/mulle-nat" target="_blank"><img class="inline-img" src="images/github-svgrepo-com.svg"></a>&nbsp;&nbsp;<a href="//github.com/mulle-nat" target="_blank" class="link">Github</a></div>
               <div class="author-social"><a href="//twitch.tv/Mulle_kybernetiK_TV" target="_blank"><img class="inline-img" src="images/twitch-svgrepo-com.svg"></a>&nbsp;&nbsp;<a href="//twitch.tv/Mulle_kybernetiK_TV" target="_blank" class="link">Twitch</a></div>
</div> <!-- bio -->

            <div class="title">
            <div>
               <h2>De Re mulle-sde&nbsp;<div style="font-size:10px; display: inline-block;">1.1.0</div>&nbsp;&nbsp;<a href="feed.xml"><img class="inline-img" src="/de-re-mulle-sde/images/feed-icon-28x28.png"></a></h2>
               <h7></h7>
            </div>
            <h6>© 2022-2024 by Nat!, Mulle kybernetiK. All rights reserved.</h6>
            <p>
         </div> <!-- title -->

            <div class="contents">
            <h4>Contents</h4>
            <ul>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/intro.html" title="Intro">Intro</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/existing-makefile.html" title="🔶 Manage a Makefile project 🆕">🔶 Manage a Makefile project 🆕</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/virtual-env.html" title="🌳 Virtual Environment">🌳 Virtual Environment</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/template.html" title="🕋 Template generator">🕋 Template generator</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/compositor.html" title="🌲 Project Compositor">🌲 Project Compositor</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/builder.html" title="🚬 Fetch and build">🚬 Fetch and build</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/makefile.html" title="💠 Makefile maintainer">💠 Makefile maintainer</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/test-coverage.html" title="☑︎ Test suite with Coverage 🆕">☑︎ Test suite with Coverage 🆕</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/definition.html" title="💄 Definition isolator">💄 Definition isolator</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/outro.html" title="Outro">Outro</a>
               </article>
            
               <article>
                  <li class="no-bullet"><a class="internal-link" href="/de-re-mulle-sde/hecklers-corner.html" title="Hecklers Corner">Hecklers Corner</a>
               </article>
            
            </ul>
            <h5>&nbsp;&nbsp;&nbsp;Or read it like a <a href="book.html"><b>book</b></a>.</h6>
</div> <!-- contents -->

            </div> <!-- sideline -->

         </div>
         <div id="post-second" class="eight columns">
            <div class="title">
            <div>
               <h2>De Re mulle-sde&nbsp;<div style="font-size:10px; display: inline-block;">1.1.0</div>&nbsp;&nbsp;<a href="feed.xml"><img class="inline-img" src="/de-re-mulle-sde/images/feed-icon-28x28.png"></a></h2>
               <h7></h7>
            </div>
            <h6>© 2022-2024 by Nat!, Mulle kybernetiK. All rights reserved.</h6>
            <p>
         </div> <!-- title -->

            <p>
                        <div id="main" role="main">
               <article>
                  <h1>💄 Definition isolator</h1>
                  <div>
                  <p>The mulle-sde <a href="virtual_env.html">virtual environment</a> shields the project from
unintentional environment settings. But that is not enough separation, if the
project is made up of multiple projects (a.k.a. “dependencies”).</p>

<p>Here is a contrived example. The main project get its current version via the
commandline like <code class="language-plaintext highlighter-rouge">cc -DVERSION='"1"'</code>. Lets use the mulle-sde environment to
set <code class="language-plaintext highlighter-rouge">CFLAGS</code>, assuming that this is picked up by the Makefile.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mulle-sde environment <span class="nb">set </span>CFLAGS <span class="s1">'-DVERSION="1"'</span>
</code></pre></div></div>

<p>It will work fine, until you add a third-party dependency, which also uses a
<code class="language-plaintext highlighter-rouge">VERSION</code> definition. As the mulle-sde environment is active during the build
of the project and the build of the dependency, there will be a clash.</p>

<h2 id="definitions-environments-for-a-build">Definitions: environments for a build</h2>

<p><em>mulle-make</em> is the meta-builder, that uses build systems like <em>cmake</em> and
<em>autoconf</em> and <em>xcodebuild</em>, to build a dependency or the project itself.
That may sound fancy, but is really not much more than what this little script
does:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#! /bin/sh</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> CMakeLists.txt <span class="o">]</span>
<span class="k">then
   </span>cmake <span class="nt">-B</span> build <span class="nt">-S</span> <span class="nb">.</span>
   cmake <span class="nt">--build</span> build
<span class="k">else</span>
    <span class="c"># use some other build tool</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>One thing <em>mulle-make</em> adds to the process, is that it looks at variables that
start with the string ‘DEFINITION_’ and uses those to create options for
the individual build tool (unknown options are passed verbatim).</p>

<p>For example the value of <code class="language-plaintext highlighter-rouge">DEFINITION_CFLAGS='-DVERSION="1"'</code> will be used
by the <em>cmake</em>  plugin of mulle-make to produce a
<code class="language-plaintext highlighter-rouge">-DCMAKE_C_FLAGS='-DVERSION="1"'</code> command line option for cmake.</p>

<p>So how are <code class="language-plaintext highlighter-rouge">DEFINITION_</code> variables set in mulle-make ? They are fed to
mulle-make by another tool mulle-craft. mulle-craft searches for applicable
definition folders and applies them to the mulle-make call. There can be
multiple definitions, which enables inheritance schemes.</p>

<h2 id="project-definitions">Project definitions</h2>

<p>The main project <code class="language-plaintext highlighter-rouge">definition</code> folder is managed with the <code class="language-plaintext highlighter-rouge">mulle-sde definition</code>
commands. The values contained in it are only used for the main project and can
not be overridden.</p>

<p><img src="images/definition1.svg" alt="Project definitions" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>foo
cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"1"'</span> ...
</code></pre></div></div>

<h2 id="dependency-definitions">Dependency definitions</h2>

<p>A dependency definition is just a project definition from a different
perspective. Here a third party project may very well also have a <code class="language-plaintext highlighter-rouge">definition</code>
folder, if it is a mulle-sde project. This definition will be used during
its build. But it will not interfere with the main project craft.</p>

<p><img src="images/definition2.svg" alt="Dependency definitions" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>
   <span class="nb">cd </span>foo/stash/bar
   cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"2"'</span> ...
<span class="o">)</span>

<span class="nb">cd </span>foo
cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"1"'</span> ...
</code></pre></div></div>

<h2 id="project-craftinfos">Project craftinfos</h2>

<p>The project has the option to override dependency definitions with <code class="language-plaintext highlighter-rouge">craftinfos</code>.
This is especially useful for third party projects, that are not mulle-sde
projects. With a <em>craftinfo</em> you can tweak the build process of that dependency
to your liking without having to edit the dependency source itself.</p>

<p><img src="images/definition3.svg" alt="Project craftinfos" /></p>

<p>The values in the <em>craftinfo</em> will usually override the values in the
<em>definition</em> of the dependency. So <code class="language-plaintext highlighter-rouge">-DVERSION="3"</code> will be in effect for
the craft of “bar”.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>
   <span class="nb">cd </span>foo/stash/bar
   cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"3"'</span> ...
<span class="o">)</span>

<span class="nb">cd </span>foo
cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"1"'</span> ...
</code></pre></div></div>

<h2 id="inherited-definitions">Inherited definitions</h2>

<p>Maybe the most powerful feature of the mulle-sde build system are inherited
<em>definitions</em>. These definitions are installed by dependencies into the
<code class="language-plaintext highlighter-rouge">dependency/share</code> folder and can affect all consecutive dependencies.
This for example allows the switch of compilers during the craft of
dependencies.</p>

<p>Multiple dependencies can add and subtract from these definitions.</p>

<p><img src="images/definition4.svg" alt="Inherited craftinfos" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>
   <span class="nb">cd </span>foo/stash/bar
   cc <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"3"'</span> ...
<span class="o">)</span>

<span class="nb">cd </span>foo
mulle-clang <span class="nt">-DVERSION</span><span class="o">=</span><span class="s1">'"1"'</span> ...
</code></pre></div></div>

<p>Inherited definitions can augment the <em>definitions</em> of the main project, but
it can not override them.</p>

<p>Inherited definitions can override the <em>definitions</em> of dependencies, but
it does not override <em>craftinfos</em>.</p>


                  </div>
               </article>
            </div>

            <p>
            
   <div class="left-right" id="pn-container">
      <div class="left-half">
         
            <span class="link">
               Back to <a rel="prev" class="internal-link" href="/de-re-mulle-sde/test-coverage.html">☑︎ Test suite with Coverage 🆕</a>
            </span>
         
      </div>
      <div class="right-half">
         
            <span class="link">
               Next <a rel="next" class="internal-link" href="/de-re-mulle-sde/outro.html">Outro</a>
            </span>
         
      </div>
   </div> <!-- left_right -->

         </div> <!-- eight columns -->
      </div> <!-- row -->


   </div> <!-- container -->
   <!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setCookieDomain", "*.www.mulle-kybernetik.com"]);
  _paq.push(["setDomains", ["*.www.mulle-kybernetik.com"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//www.mulle-kybernetik.com/matomo/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//www.mulle-kybernetik.com/matomo/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt="" /></p></noscript>
<!-- End Matomo Code -->

</body>
</html>
